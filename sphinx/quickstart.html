<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quick start &mdash; ocaml-canvas master
 (23de080
) (2024/06/14 08:18) documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/fixes.css" type="text/css" />
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Copyright and License" href="license.html" />
    <link rel="prev" title="How to install" href="install.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> ocaml-canvas
          </a>
              <div class="version">
                master
 (23de080
)
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://ocamlpro.github.io/ocaml-canvas">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">How to install</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#initialization">Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-canvases">Creating canvases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#drawing-on-canvases">Drawing on canvases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#handling-canvas-events">Handling canvas events</a></li>
<li class="toctree-l2"><a class="reference internal" href="#an-actual-example">An actual example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://ocamlpro.github.io/ocaml-canvas/doc">API doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">Copyright and License</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ocamlpro/ocaml-canvas">Devel and Issues on Github</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ocaml-canvas</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Quick start</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/quickstart.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="quick-start">
<h1>Quick start<a class="headerlink" href="#quick-start" title="Permalink to this headline"></a></h1>
<section id="initialization">
<h2>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline"></a></h2>
<p>Before using any function in the library (and assuming the <code class="code docutils literal notranslate"><span class="pre">OcamlCanvas.V1</span></code>
module has been opened), the user should call <code class="code docutils literal notranslate"><span class="pre">Backend.init</span></code> so that
the library makes any internal initialization it needs for the current
backend.</p>
</section>
<section id="creating-canvases">
<h2>Creating canvases<a class="headerlink" href="#creating-canvases" title="Permalink to this headline"></a></h2>
<p>Once the backend is initialized, one can create Canvas objects using
the <code class="code docutils literal notranslate"><span class="pre">Canvas.createOnscreen</span></code> and <code class="code docutils literal notranslate"><span class="pre">Canvas.createOffscreen</span></code> functions.
The first one creates canvases contained in regular windows (which are
simulated in the Javascript backend), while the second one creates
canvases that are not rendered on screen, which can be useful to save
complex images that can then simply be copied to a visible canvas.
Onscreen canvases are hidden by default, and <code class="code docutils literal notranslate"><span class="pre">Canvas.show</span></code>
should be called on them to make them visible.</p>
</section>
<section id="drawing-on-canvases">
<h2>Drawing on canvases<a class="headerlink" href="#drawing-on-canvases" title="Permalink to this headline"></a></h2>
<p>Drawing on a canvas can be perfomed using various drawing primitives,
the most ubiquitous being <code class="code docutils literal notranslate"><span class="pre">Canvas.clearPath</span></code>, <code class="code docutils literal notranslate"><span class="pre">Canvas.moveTo</span></code>,
<code class="code docutils literal notranslate"><span class="pre">Canvas.lineTo</span></code>, <code class="code docutils literal notranslate"><span class="pre">Canvas.arc</span></code>, <code class="code docutils literal notranslate"><span class="pre">Canvas.bezierCurveTo</span></code>, <code class="code docutils literal notranslate"><span class="pre">Canvas.fill</span></code>
and <code class="code docutils literal notranslate"><span class="pre">Canvas.stroke</span></code>. These functions allow to build a path step by step
and either fill it completely or draw its outline. It is also possible
to directly render some text with the <code class="code docutils literal notranslate"><span class="pre">Canvas.fillText</span></code> and
<code class="code docutils literal notranslate"><span class="pre">Canvas.strokeText</span></code> functions.</p>
<p>The canvas drawing style can be customized using functions
such as <code class="code docutils literal notranslate"><span class="pre">Canvas.setFillColor</span></code>, <code class="code docutils literal notranslate"><span class="pre">Canvas.setStrokeColor</span></code> or
<code class="code docutils literal notranslate"><span class="pre">Canvas.setLineWidth</span></code>. The font used to draw text can be specified
with the <code class="code docutils literal notranslate"><span class="pre">Canvas.setFont</span></code> function. It is also possible to apply
various transformations to a canvas, such as translation, rotation and
scaling, with the functions <code class="code docutils literal notranslate"><span class="pre">Canvas.transform</span></code>, <code class="code docutils literal notranslate"><span class="pre">Canvas.translate</span></code>,
<code class="code docutils literal notranslate"><span class="pre">Canvas.scale</span></code>, <code class="code docutils literal notranslate"><span class="pre">Canvas.rotate</span></code> and <code class="code docutils literal notranslate"><span class="pre">Canvas.shear</span></code>. All these
styling elements can be saved and restored to/from a state stack
using the functions <code class="code docutils literal notranslate"><span class="pre">Canvas.save</span></code> and <code class="code docutils literal notranslate"><span class="pre">Canvas.restore</span></code>.</p>
</section>
<section id="handling-canvas-events">
<h2>Handling canvas events<a class="headerlink" href="#handling-canvas-events" title="Permalink to this headline"></a></h2>
<p>Once the canvases are ready, we may start handling events for these
canvases. To do so, we use the <code class="code docutils literal notranslate"><span class="pre">Backend.run</span></code> function, which runs an
event loop. <strong>This function MUST be the last instruction of the program</strong>.
It takes a single argument, which is a function to be executed when the
event loop has finished running. The event loop may be stopped by calling
<code class="code docutils literal notranslate"><span class="pre">Backend.stop</span></code> from any update function.</p>
<p>Each event reports at least the canvas on which it occured, and its
timestamp. It may also report mouse coordinates for mouse events,
or keyboard status for keyboard events.</p>
</section>
<section id="an-actual-example">
<h2>An actual example<a class="headerlink" href="#an-actual-example" title="Permalink to this headline"></a></h2>
<p>The following program creates a windowed canvas with an orange background,
a cyan border, and the “Hello world !” text drawn rotated in the middle.
The user may press the “Escape” key or close the window to exit the
program. It will show the number of frames displayed when quitting.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">open</span> <span class="nn">OcamlCanvas</span><span class="p">.</span><span class="nc">V1</span>

<span class="k">let</span> <span class="bp">()</span> <span class="o">=</span>

  <span class="nn">Backend</span><span class="p">.</span><span class="n">init</span> <span class="bp">()</span><span class="o">;</span>

  <span class="k">let</span> <span class="n">c</span> <span class="o">=</span> <span class="nn">Canvas</span><span class="p">.</span><span class="n">createOnscreen</span> <span class="o">~</span><span class="n">title</span><span class="o">:</span><span class="s2">&quot;Hello world&quot;</span>
            <span class="o">~</span><span class="n">pos</span><span class="o">:(</span><span class="mi">300</span><span class="o">,</span> <span class="mi">200</span><span class="o">)</span> <span class="o">~</span><span class="n">size</span><span class="o">:(</span><span class="mi">300</span><span class="o">,</span> <span class="mi">200</span><span class="o">)</span> <span class="bp">()</span> <span class="k">in</span>

  <span class="nn">Canvas</span><span class="p">.</span><span class="n">setFillColor</span> <span class="n">c</span> <span class="nn">Color</span><span class="p">.</span><span class="n">orange</span><span class="o">;</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">fillRect</span> <span class="n">c</span> <span class="o">~</span><span class="n">pos</span><span class="o">:(</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">)</span> <span class="o">~</span><span class="n">size</span><span class="o">:(</span><span class="mi">300</span><span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="mi">200</span><span class="o">.</span><span class="mi">0</span><span class="o">);</span>

  <span class="nn">Canvas</span><span class="p">.</span><span class="n">setStrokeColor</span> <span class="n">c</span> <span class="nn">Color</span><span class="p">.</span><span class="n">cyan</span><span class="o">;</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">setLineWidth</span> <span class="n">c</span> <span class="mi">10</span><span class="o">.</span><span class="mi">0</span><span class="o">;</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">clearPath</span> <span class="n">c</span><span class="o">;</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">moveTo</span> <span class="n">c</span> <span class="o">(</span><span class="mi">5</span><span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="mi">5</span><span class="o">.</span><span class="mi">0</span><span class="o">);</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">lineTo</span> <span class="n">c</span> <span class="o">(</span><span class="mi">295</span><span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="mi">5</span><span class="o">.</span><span class="mi">0</span><span class="o">);</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">lineTo</span> <span class="n">c</span> <span class="o">(</span><span class="mi">295</span><span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="mi">195</span><span class="o">.</span><span class="mi">0</span><span class="o">);</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">lineTo</span> <span class="n">c</span> <span class="o">(</span><span class="mi">5</span><span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="mi">195</span><span class="o">.</span><span class="mi">0</span><span class="o">);</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">closePath</span> <span class="n">c</span><span class="o">;</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">stroke</span> <span class="n">c</span><span class="o">;</span>

  <span class="nn">Canvas</span><span class="p">.</span><span class="n">setFont</span> <span class="n">c</span> <span class="s2">&quot;Liberation Sans&quot;</span> <span class="o">~</span><span class="n">size</span><span class="o">:</span><span class="mi">36</span><span class="o">.</span><span class="mi">0</span>
    <span class="o">~</span><span class="n">slant</span><span class="o">:</span><span class="nn">Font</span><span class="p">.</span><span class="nc">Roman</span> <span class="o">~</span><span class="n">weight</span><span class="o">:</span><span class="nn">Font</span><span class="p">.</span><span class="n">bold</span><span class="o">;</span>

  <span class="nn">Canvas</span><span class="p">.</span><span class="n">setFillColor</span> <span class="n">c</span> <span class="o">(</span><span class="nn">Color</span><span class="p">.</span><span class="n">of_rgb</span> <span class="mi">0</span> <span class="mi">64</span> <span class="mi">255</span><span class="o">);</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">setLineWidth</span> <span class="n">c</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span><span class="o">;</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">save</span> <span class="n">c</span><span class="o">;</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">translate</span> <span class="n">c</span> <span class="o">(</span><span class="mi">150</span><span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="mi">100</span><span class="o">.</span><span class="mi">0</span><span class="o">);</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">rotate</span> <span class="n">c</span> <span class="o">(-.</span> <span class="nn">Const</span><span class="p">.</span><span class="n">pi_8</span><span class="o">);</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">fillText</span> <span class="n">c</span> <span class="s2">&quot;Hello world !&quot;</span> <span class="o">(-</span><span class="mi">130</span><span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="mi">20</span><span class="o">.</span><span class="mi">0</span><span class="o">);</span>
  <span class="nn">Canvas</span><span class="p">.</span><span class="n">restore</span> <span class="n">c</span><span class="o">;</span>

  <span class="nn">Canvas</span><span class="p">.</span><span class="n">show</span> <span class="n">c</span><span class="o">;</span>

  <span class="k">let</span> <span class="n">e1</span> <span class="o">=</span>
    <span class="nn">React</span><span class="p">.</span><span class="nn">E</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="o">{</span> <span class="nn">Event</span><span class="p">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="o">_;</span> <span class="n">timestamp</span> <span class="o">=</span> <span class="o">_;</span> <span class="n">data</span> <span class="o">=</span> <span class="bp">()</span> <span class="o">}</span> <span class="o">-&gt;</span>
        <span class="nn">Backend</span><span class="p">.</span><span class="n">stop</span> <span class="bp">()</span>
      <span class="o">)</span> <span class="nn">Event</span><span class="p">.</span><span class="n">close</span>
  <span class="k">in</span>

  <span class="k">let</span> <span class="n">e2</span> <span class="o">=</span>
    <span class="nn">React</span><span class="p">.</span><span class="nn">E</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="o">{</span> <span class="nn">Event</span><span class="p">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="o">_;</span> <span class="n">timestamp</span> <span class="o">=</span> <span class="o">_;</span>
                       <span class="n">data</span> <span class="o">=</span> <span class="o">{</span> <span class="nn">Event</span><span class="p">.</span><span class="n">key</span><span class="o">;</span> <span class="kt">char</span> <span class="o">=</span> <span class="o">_;</span> <span class="n">flags</span> <span class="o">=</span> <span class="o">_</span> <span class="o">};</span> <span class="o">_</span> <span class="o">}</span> <span class="o">-&gt;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">=</span> <span class="nc">KeyEscape</span> <span class="k">then</span>
          <span class="nn">Backend</span><span class="p">.</span><span class="n">stop</span> <span class="bp">()</span>
      <span class="o">)</span> <span class="nn">Event</span><span class="p">.</span><span class="n">key_down</span>
  <span class="k">in</span>

  <span class="k">let</span> <span class="n">e3</span> <span class="o">=</span>
    <span class="nn">React</span><span class="p">.</span><span class="nn">E</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="o">{</span> <span class="nn">Event</span><span class="p">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="o">_;</span> <span class="n">timestamp</span> <span class="o">=</span> <span class="o">_;</span>
                       <span class="n">data</span> <span class="o">=</span> <span class="o">{</span> <span class="nn">Event</span><span class="p">.</span><span class="n">position</span> <span class="o">=</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">);</span> <span class="n">button</span> <span class="o">}</span> <span class="o">}</span> <span class="o">-&gt;</span>
        <span class="nn">Canvas</span><span class="p">.</span><span class="n">setFillColor</span> <span class="n">c</span> <span class="nn">Color</span><span class="p">.</span><span class="n">red</span><span class="o">;</span>
        <span class="nn">Canvas</span><span class="p">.</span><span class="n">clearPath</span> <span class="n">c</span><span class="o">;</span>
        <span class="nn">Canvas</span><span class="p">.</span><span class="n">arc</span> <span class="n">c</span> <span class="o">~</span><span class="n">center</span><span class="o">:(</span><span class="n">float_of_int</span> <span class="n">x</span><span class="o">,</span> <span class="n">float_of_int</span> <span class="n">y</span><span class="o">)</span>
          <span class="o">~</span><span class="n">radius</span><span class="o">:</span><span class="mi">5</span><span class="o">.</span><span class="mi">0</span> <span class="o">~</span><span class="n">theta1</span><span class="o">:</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span> <span class="o">~</span><span class="n">theta2</span><span class="o">:(</span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span> <span class="o">*.</span> <span class="nn">Const</span><span class="p">.</span><span class="n">pi</span><span class="o">)</span> <span class="o">~</span><span class="n">ccw</span><span class="o">:</span><span class="bp">false</span><span class="o">;</span>
        <span class="nn">Canvas</span><span class="p">.</span><span class="n">fill</span> <span class="n">c</span> <span class="o">~</span><span class="n">nonzero</span><span class="o">:</span><span class="bp">false</span>
      <span class="o">)</span> <span class="nn">Event</span><span class="p">.</span><span class="n">button_down</span>
  <span class="k">in</span>

  <span class="k">let</span> <span class="n">frames</span> <span class="o">=</span> <span class="n">ref</span> <span class="mi">0</span><span class="n">L</span> <span class="k">in</span>

  <span class="k">let</span> <span class="n">e4</span> <span class="o">=</span>
    <span class="nn">React</span><span class="p">.</span><span class="nn">E</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="o">{</span> <span class="nn">Event</span><span class="p">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="o">_;</span> <span class="n">timestamp</span> <span class="o">=</span> <span class="o">_</span> <span class="o">}</span> <span class="o">-&gt;</span>
        <span class="n">frames</span> <span class="o">:=</span> <span class="nn">Int64</span><span class="p">.</span><span class="n">add</span> <span class="o">!</span><span class="n">frames</span> <span class="nn">Int64</span><span class="p">.</span><span class="n">one</span>
      <span class="o">)</span> <span class="nn">Event</span><span class="p">.</span><span class="n">frame</span>
  <span class="k">in</span>

  <span class="nn">Backend</span><span class="p">.</span><span class="n">run</span> <span class="o">(</span><span class="k">fun</span> <span class="bp">()</span> <span class="o">-&gt;</span>
      <span class="n">ignore</span> <span class="n">e1</span><span class="o">;</span> <span class="n">ignore</span> <span class="n">e2</span><span class="o">;</span> <span class="n">ignore</span> <span class="n">e3</span><span class="o">;</span> <span class="n">ignore</span> <span class="n">e4</span><span class="o">;</span>
      <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;Displayed %Ld frames. Goodbye !</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">!</span><span class="n">frames</span><span class="o">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="install.html" class="btn btn-neutral float-left" title="How to install" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="license.html" class="btn btn-neutral float-right" title="Copyright and License" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright OCamlPro SAS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>